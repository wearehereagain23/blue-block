<!DOCTYPE html>

<html class="loading" lang="en" data-textdirection="ltr">




<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>Account Settings | Blue Block</title>

    <link rel="shortcut icon" type="image/x-icon" href="../profile/index/secured/images/favicon.png">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../profile/index/secured/app-assets/vendors/vendors.min.css">
    <link rel="stylesheet" type="text/css"
        href="../profile/index/secured/app-assets/css/themes/vertical-modern-menu-template/materialize.min.css">
    <link rel="stylesheet" type="text/css"
        href="../profile/index/secured/app-assets/css/themes/vertical-modern-menu-template/style.min.css">

    <link rel="stylesheet" type="text/css"
        href="../profile/index/secured/app-assets/css/pages/page-account-settings.min.css">
    <link rel="stylesheet" type="text/css" href="../profile/index/secured/app-assets/css/custom/custom.css">

    <style>
        .sidenav li a.collapsible-header>i.material-icons,
        .sidenav li>a>i.material-icons {

            color: #562fa1;
        }
    </style>

    <style>
        /* PC View Enhancements: Stretching the sidebar height */
        .sidenav-main {
            height: 100vh !important;
            padding-bottom: 50px;
        }

        /* Header & Mobile Logo Styling */
        .mobile-header-logo {
            height: 40px;
            margin-top: 10px;
            object-fit: contain;
        }

        /* Padding for header profile image to prevent touching corners */
        .navbar-list .profile-button {
            padding: 0 15px !important;
            display: flex;
            align-items: center;
        }

        /* Mobile Bottom Nav */
        .mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 65px;
            background: #01123c;
            display: none;
            justify-content: space-around;
            align-items: center;
            z-index: 999;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
            border-top: 1px solid #1e88e5;
        }

        .mobile-nav-item {
            color: #fff;
            text-align: center;
            font-size: 10px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }



        .mobile-nav-item.active {
            color: #fb8c00;
            /* Highlight color for active page */
        }

        .mobile-nav-item i {
            font-size: 24px;
            margin-bottom: 2px;
        }



        @media only screen and (max-width: 992px) {

            .sidenav-main,
            .sidenav-trigger {
                display: none !important;
            }

            .mobile-bottom-nav {
                display: flex;
            }

            #main {
                padding-bottom: 70px;
            }
        }

        /* Ensure the Topbar is strictly pinned and opaque */
        .page-topbar {
            position: fixed !important;
            top: 0;
            width: 100%;
            z-index: 1001 !important;
            /* Higher than sidenav and content */
            background: #01123c !important;
            /* Matches Blue Block brand navy */
        }

        /* Force the Nav bar to respect iOS Safe Areas */
        .navbar {
            padding-top: env(safe-area-inset-top);
            height: calc(64px + env(safe-area-inset-top)) !important;
        }

        /* Prevent content from sliding under the header on start */
        #main {
            padding-top: calc(64px + env(safe-area-inset-top)) !important;
        }
    </style>

    <!-- BEGIN VENDOR JS-->
    <script src="../profile/index/secured/app-assets/js/vendors.min.js"></script>
    <!-- BEGIN VENDOR JS-->
    <!-- BEGIN PAGE VENDOR JS-->

    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN THEME  JS-->
    <script src="../profile/index/secured/app-assets/js/plugins.min.js"></script>
    <script src="../profile/index/secured/app-assets/js/search.min.js"></script>
    <!-- END THEME  JS-->

    <script src="../profile/index/secured/wallet-address-validator-master/wallet-address-validator.min.js"></script>

    <!-- POPUP SCRIPT -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../../config.js"></script>

    <script type="module">
        import { supabase, AuthService, handleGlobalLogout } from '../../supabase.js';

        // Global state
        let currentUser = null;

        // --- 1. FORMATTING UTILITIES ---
        // This fixes the "format is not defined" error
        const format = {
            date: (isoString) => {
                if (!isoString) return "N/A";
                return new Date(isoString).toLocaleDateString('en-GB', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });
            }
        };

        function setupVisibilityRealtime() {
            supabase
                .channel('public_status')
                .on(
                    'postgres_changes',
                    { event: 'UPDATE', schema: 'public', table: 'admin', filter: 'id=eq.1' },
                    (payload) => {
                        // If visibility is turned off while user is on page
                        if (payload.new.website_visibility === false) {
                            AuthService.removeSession();
                            window.location.href = '../../505.html';
                        }
                    }
                )
                .subscribe();
        }

        /**
         * INITIAL CHECK & STARTUP
         */
        async function startDashboardSecurely() {
            // 1. Initial Fetch (Immediate check on load)
            const { data: admin } = await supabase
                .from('admin')
                .select('website_visibility')
                .eq('id', 1)
                .single();

            if (admin && admin.website_visibility === false) {
                AuthService.removeSession();
                window.location.href = '../../505.html';
                return;
            }

            // 2. Start Realtime Watcher (Wait for changes)
            setupVisibilityRealtime();

            // 3. Continue with your existing dashboard functions
            const userId = AuthService.getSession();
            if (userId) {
                initDashboard(); // Your existing function
                initPage();      // Your existing function
            } else {
                window.location.href = '../../login/index.html';
            }
        }

        // Execute the secure startup
        startDashboardSecurely();

        // --- 2. GLOBAL ACTIONS (Attached to window for HTML buttons) ---

        window.copyLoginID = function () {
            const copyText = document.getElementById("loginIDDisplay");
            if (!copyText || copyText.value === "Loading..." || !copyText.value) return;

            copyText.select();
            navigator.clipboard.writeText(copyText.value);
            Swal.fire({
                title: 'Copied!',
                text: 'Login ID saved to clipboard',
                icon: 'success',
                timer: 1000,
                showConfirmButton: false
            });
        };

        window.updateLoginID = async function () {
            if (!currentUser) {
                Swal.fire({ title: 'Error', text: 'User session not loaded.', icon: 'error' });
                return;
            }

            const result = await Swal.fire({
                title: 'Regenerate Trading ID?',
                text: "Generate a new Login ID?",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#fb8c00',
                confirmButtonText: 'Yes, generate'
            });

            if (result.value || result.isConfirmed) {
                showSpinnerModal();

                // MT5 style: 15 characters alphanumeric
                const charset = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                let newID = "";
                for (let i = 0; i < 15; i++) {
                    newID += charset.charAt(Math.floor(Math.random() * charset.length));
                }

                try {
                    const { error } = await supabase
                        .from('user_profiles')
                        .update({ login_ID: newID })
                        .eq('uuid', currentUser.uuid);

                    if (error) throw error;

                    // Update UI display immediately
                    document.getElementById("loginIDDisplay").value = newID;

                    Swal.fire({
                        title: 'Updated!',
                        text: `New MT5 ID: ${newID}`,
                        icon: 'success'
                    });
                } catch (err) {
                    console.error("Update Error:", err);
                    Swal.fire({ title: 'Failed', text: err.message, icon: 'error' });
                } finally {
                    hideSpinnerModal();
                }
            }
        };

        // --- 3. UI & SPINNER HELPERS ---

        function showSpinnerModal() {
            const modal = document.getElementById('spinnerModal');
            if (modal) modal.style.display = 'flex';
        }

        function hideSpinnerModal() {
            const modal = document.getElementById('spinnerModal');
            if (modal) modal.style.display = 'none';
        }


        function updateUI(user) {
            // 1. Update Names and Country Display
            console.log('this is the state log', user.currency);

            const fullName = `${user.first_name || ''} ${user.last_name || ''}`.trim() || "User";
            ["weuss", "weuss2"].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerText = fullName;
            });

            ["country", "country2"].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerText = user.country || "Not Set";
            });

            const flagSrc = user.countryFlag || "../profile/index/secured/images/userlogo.png";
            ["flag", "flag2"].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.src = flagSrc;
            });

            // 2. Main Form Inputs
            if (document.getElementById("firstName")) document.getElementById("firstName").value = user.first_name || "";
            if (document.getElementById("lastName")) document.getElementById("lastName").value = user.last_name || "";
            if (document.getElementById("phone")) document.getElementById("phone").value = user.phone_number || "";
            if (document.getElementById("email")) document.getElementById("email").value = user.email || "";

            // 3. New Specific Fields (Gender, Currency, State)
            if (document.getElementById("gender")) {
                document.getElementById("gender").value = user.gender || "";
            }


            if (document.getElementById("state")) {
                document.getElementById("state").value = user.state || "";
            }

            // 4. Date of Birth Formatting (Strict YYYY-MM-DD for input type="date")
            const dobInput = document.getElementById("dataof_birth");
            if (dobInput && user.dataof_birth) {
                try {
                    const dateObj = new Date(user.dataof_birth);
                    if (!isNaN(dateObj.getTime())) {
                        // Extracts only the YYYY-MM-DD portion
                        dobInput.value = dateObj.toISOString().split('T')[0];
                    } else {
                        dobInput.value = user.dataof_birth;
                    }
                } catch (e) {
                    console.error("Date of Birth parsing error:", e);
                }
            }

            // 5. Registration Date
            if (document.getElementById("date")) {
                document.getElementById("date").value = format.date(user.created_at);
            }

            // 6. Account IDs & Avatars
            const idInput = document.getElementById("loginIDDisplay");
            if (idInput) idInput.value = user.login_ID || "Not Assigned";

            const profileImg = user.profile_picture || "../profile/index/secured/images/userlogo.png";
            ["pmler", "pmler2", "pmler3"].forEach(id => {
                const img = document.getElementById(id);
                if (img) img.src = profileImg;
            });

            // 7. CRITICAL: Refresh Materialize Components
            // M.updateTextFields() moves labels up so they don't overlap the new text
            if (typeof M !== 'undefined' && M.updateTextFields) {
                M.updateTextFields();
            }
        }


        function subscribeToUserChanges(userId) {
            supabase
                .channel(`user-profile-sync-${userId}`)
                .on('postgres_changes', {
                    event: 'UPDATE',
                    schema: 'public',
                    table: 'user_profiles',
                    filter: `uuid=eq.${userId}`
                }, (payload) => {
                    currentUser = payload.new;
                    updateUI(payload.new);

                    // Use Swal Toast instead of M.toast to avoid errors
                    Swal.fire({
                        title: 'Synced!',
                        text: 'Account details updated',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false,
                        toast: true,
                        position: 'top-end'
                    });
                })
                .subscribe();
        }

        async function initializeProfilePage() {
            showSpinnerModal();
            const userId = AuthService.getSession();

            if (!userId) {
                window.location.href = "../../login/index.html";
                return;
            }

            try {
                const user = await AuthService.fetchProfile(userId);
                if (user && user.active === 'Active') {
                    currentUser = user;
                    updateUI(user);
                    subscribeToUserChanges(userId);
                } else {
                    window.location.href = "../../login/index.html";
                }
            } catch (err) {
                console.error("Initialization Error:", err.message);
            } finally {
                hideSpinnerModal();
            }
        }

        // --- 5. FORM LISTENERS ---

        document.getElementById('userfom').addEventListener('submit', async (event) => {
            event.preventDefault();
            showSpinnerModal();
            const updates = {
                first_name: document.getElementById('firstName').value,
                last_name: document.getElementById('lastName').value,
                phone_number: document.getElementById('phone').value,
                gender: document.getElementById('gender').value,
                dataof_birth: document.getElementById('dataof_birth').value,
                state: document.getElementById('state').value
            };
            try {
                const { error } = await supabase.from('user_profiles').update(updates).eq('uuid', currentUser.uuid);
                if (error) throw error;
                Swal.fire({ title: 'Success', text: 'Profile updated', icon: 'success' });
            } catch (err) {
                Swal.fire({ title: 'Error', text: err.message, icon: 'error' });
            } finally {
                hideSpinnerModal();
            }
        });

        document.getElementById('passch').addEventListener('submit', async (event) => {
            event.preventDefault();
            const oldPass = document.getElementById('oldPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const newPass2 = document.getElementById('newPassword2').value;

            if (oldPass !== currentUser.password) {
                return Swal.fire({ title: 'Error', text: 'Current password incorrect', icon: 'error' });
            }
            if (newPass !== newPass2) {
                return Swal.fire({ title: 'Error', text: 'New passwords do not match', icon: 'error' });
            }

            showSpinnerModal();
            try {
                const { error } = await supabase.from('user_profiles')
                    .update({ password: newPass })
                    .eq('uuid', currentUser.uuid);
                if (error) throw error;
                Swal.fire({ title: 'Success', text: 'Password updated', icon: 'success' });
            } catch (err) {
                Swal.fire({ title: 'Error', text: err.message, icon: 'error' });
            } finally {
                hideSpinnerModal();
            }
        });

        document.getElementById('imageUpload').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (!file) return;
            showSpinnerModal();
            try {
                const filePath = `profiles/${currentUser.uuid}/${Date.now()}.${file.name.split('.').pop()}`;
                const { data, error: upErr } = await supabase.storage.from('profileimages').upload(filePath, file);
                if (upErr) throw upErr;

                const { data: { publicUrl } } = supabase.storage.from('profileimages').getPublicUrl(data.path);
                await supabase.from('user_profiles').update({ profile_picture: publicUrl }).eq('uuid', currentUser.uuid);
                location.reload();
            } catch (err) {
                Swal.fire({ title: 'Error', text: err.message, icon: 'error' });
                hideSpinnerModal();
            }
        });

        initializeProfilePage();


        // Add these to your existing script module

        // 1. History Options Popup for Mobile
        window.showHistoryOptions = function () {
            Swal.fire({
                title: 'Select History',
                html: `
            <div style="display:flex; flex-direction:column; gap:10px;">
                <a href="../investments/index.html" class="btn indigo">Pending Deposits</a>
                <a href="../trade_history/index.html" class="btn indigo">Trade History</a>
                <a href="../market_history/index.html" class="btn indigo">Pending Withdraws</a>
                <a href="../deposit_list/index.html" class="btn indigo">Approved Deposits</a>
                <a href="../withdrawal-history/index.html" class="btn indigo">Withdrawal History</a>
            </div>
        `,
                showConfirmButton: false,
                showCloseButton: true,
                background: '#01123c',
                customClass: { title: 'white-text' }
            });
        };

        // 2. Fixed Logout Logic
        // There was a bug where the logout listener wasn't attached correctly
        const logoutBtn = document.getElementById('out');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', () => {
                Swal.fire({
                    title: 'Logout?',
                    text: "You will be signed out of your session",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#fb8c00',
                    confirmButtonText: 'Yes, logout'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Clear local session data here if needed
                        window.location.href = "../../login/index.html";
                    }
                });
            });
        }


        async function initPage() {
            // 1. Get the session (already protected by supabase.js import)
            const userId = AuthService.getSession();

            try {
                // 2. Load User Profile
                const user = await AuthService.fetchProfile(userId);

                // Update your UI (Example)
                document.getElementById("weuss").innerHTML = `${user.first_name} ${user.last_name}`;
                document.getElementById("xxpol").innerHTML = (user.currency || '$') + user.account_balance;

            } catch (err) {
                console.error("Auth Error:", err.message);
            }
        }

        // 3. Setup Logout Buttons
        document.addEventListener('DOMContentLoaded', () => {
            const logoutButtons = document.querySelectorAll('#out, #m-logout');

            logoutButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();

                    Swal.fire({
                        title: 'Confirm Logout',
                        text: "This will log you out of all active tabs.",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#2196f3',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, logout',
                        background: '#01123c',
                        color: '#fff'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // This call triggers the 'storage' event in all other tabs
                            handleGlobalLogout(() => {
                                window.location.href = "../../login/index.html";
                            });
                        }
                    });
                });
            });
        });

        initPage();


        // Monitor and kill Jivosite default bubble if it tries to appear
        const killJivoBubble = () => {
            // Select all potential Jivo elements
            const elementsToHide = document.querySelectorAll(
                'jdiv[class^="button_"], jdiv[class^="label_"], .jivo-btn-container, #jivo-label'
            );
            elementsToHide.forEach(el => {
                el.style.setProperty('display', 'none', 'important');
                el.style.setProperty('visibility', 'hidden', 'important');
            });
        };

        // Run more frequently at start to catch the PC injection
        let jivoCounter = 0;
        const jivoKiller = setInterval(() => {
            killJivoBubble();
            if (jivoCounter++ > 20) clearInterval(jivoKiller); // Increased to 20 to be safe
        }, 300);



        window.openLiveChat = function () {
            if (typeof jivo_api !== 'undefined') {
                const container = document.getElementById('jivo-iframe-container');

                // Force CSS transition to visible
                if (container) {
                    container.classList.add('jivo-active');
                    container.style.setProperty('display', 'block', 'important');
                    container.style.setProperty('visibility', 'visible', 'important');
                    container.style.setProperty('opacity', '1', 'important');
                    container.style.setProperty('z-index', '2147483647', 'important');
                }

                // Open the native chat window
                jivo_api.open();
            } else {
                // Retry if script is still downloading
                setTimeout(window.openLiveChat, 500);
            }
        };
    </script>


</head>
<!-- END: Head-->

<body
    class="vertical-layout vertical-menu-collapsible page-header-dark vertical-modern-menu preload-transitions 2-columns   "
    data-open="click" data-menu="vertical-modern-menu" data-col="2-columns">

    <!-- BEGIN: Header-->

    <style>
        .sidenav li a.collapsible-header>i.material-icons,
        .sidenav li>a>i.material-icons {

            color: #562fa1;
        }

        /* Ensure the Nav Bar is a flexible container */
        .nav-wrapper {
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
            height: 64px;
            padding: 0 15px;
        }

        /* Group the right-side icons so they align together */
        .header-actions-right {
            display: flex;
            align-items: center;
            gap: 5px;
            /* Space between Chat and Profile */
        }

        /* Fix icon vertical alignment */
        .header-actions-right i {
            line-height: 64px;
            height: 64px;
            display: flex;
            align-items: center;
        }

        /* Responsive logo sizing */
        .mobile-header-logo {
            height: 32px;
            width: auto;
            max-width: 120px;
            object-fit: contain;
        }

        /* Prevent Footer/Sidebar jump when SweetAlert is active */
        body.swal2-shown {
            overflow-y: auto !important;
            padding-right: 0 !important;
        }

        body.swal2-height-auto {
            height: 100% !important;
        }

        /* Ensure the footer stays pinned to the bottom during transitions */
        footer.page-footer {
            position: relative;
            z-index: 10;
        }

        /* Hide Jivosite Default Bubble */
        #jivo-iframe-container,
        .jivo-iframe-container,
        jdiv[class^="button_"],
        jdiv[class^="label_"] {
            display: none !important;
            visibility: hidden !important;
        }
    </style>

    <!-- pc view nav Css -->

    <style>
        /* PC SIDEBAR - HIGH-END PROFESSIONAL UI (FIXED) */
        @media only screen and (min-width: 993px) {
            aside.sidenav-main {
                display: block !important;
                height: 100vh !important;
                width: 260px !important;
                position: fixed !important;
                top: 0;
                left: 0;
                background: #01123c !important;
                /* Deep Navy BG */
                z-index: 1000 !important;
                box-shadow: 4px 0 15px rgba(0, 0, 0, 0.5) !important;
                border-right: 1px solid rgba(255, 255, 255, 0.05);
            }

            #main {
                padding-left: 260px !important;
            }

            #slide-out {
                margin: 0 !important;
                padding: 0 !important;
                background: transparent !important;
            }

            /* ROUTE BUTTONS - FIXED FOR LONG TITLES */
            .sidenav li a {
                height: 58px !important;
                line-height: 58px !important;
                padding: 0 25px !important;
                display: flex !important;
                align-items: center;
                color: rgba(255, 255, 255, 0.7) !important;
                font-size: 14.5px !important;
                font-weight: 500;
                transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
                border-left: 0px solid #2196f3;
                /* Prevents text from splitting into two lines */
                white-space: nowrap !important;
            }

            /* STRONG HOVER EFFECT */
            .sidenav li a:hover {
                background: rgba(33, 150, 243, 0.15) !important;
                /* Light Blue Glow */
                color: #ffffff !important;
                padding-left: 35px !important;
                /* Noticeable Slide */
                border-left: 5px solid #2196f3 !important;
                /* Instant blue bar on hover */
            }

            /* ICON STYLING - VIBRANT BLUE */
            .sidenav li a i.material-icons {
                color: #2196f3 !important;
                /* Bright Material Blue */
                margin-right: 15px !important;
                font-size: 24px !important;
                transition: transform 0.3s ease;
            }

            .sidenav li a:hover i {
                transform: scale(1.2);
                /* Icon pops out on hover */
                color: #fff !important;
                /* Icon turns white on hover for contrast */
            }

            /* ACTIVE STATE */
            .sidenav li.active {
                background: rgba(33, 150, 243, 0.2) !important;
                border-left: 5px solid #2196f3;
            }

            .sidenav li.active a {
                color: #fff !important;
                font-weight: 700;
            }
        }

        /* PROFILE & FLAG AREA */
        .profile-box-custom {
            padding: 25px 15px !important;
            background: #01123c !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #flag {
            display: inline-block !important;
            /* FORCED VISIBILITY */
            width: 22px !important;
            height: 15px !important;
            margin-left: 12px !important;
            vertical-align: middle;
            object-fit: cover;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        #jivo-notification-wrapper,
        #jivositelabel,
        .jivo-btn,
        .jivo-label,
        jdiv[class^="button_"],
        jdiv[class^="label_"],
        jdiv[class*="omnichannel"],
        div[class^="jivo-host"] [class*="launcher"],
        /* New common Jivo selectors */
        div[id^="jivo-iframe-container"]:not(.jivo-active) {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
            transform: scale(0) !important;
            position: fixed !important;
            bottom: -500px !important;
            /* Move it far off screen */
        }

        #jivo-iframe-container.jivo-active {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 2147483647 !important;
            bottom: 0 !important;
            transform: scale(1) !important;
            pointer-events: auto !important;
        }
    </style>

    <header class="page-topbar" id="header">
        <div class="navbar navbar-fixed">
            <nav style="background: #01123c !important;" class="navbar-main navbar-color navbar-dark no-shadow">
                <div class="nav-wrapper">

                    <div class="header-logo-container">
                        <a href="../index.html" style="display: flex; align-items: center;">
                            <img src="../con.png" alt="Logo" class="mobile-header-logo">
                        </a>
                    </div>
                    <div class="header-actions-right">
                        <a href="javascript:void(0);" id="chat-trigger" onclick="openLiveChat()"
                            class="waves-effect waves-block waves-light"
                            style="display: flex; align-items: center; padding: 0 10px;">
                            <i class="material-icons" style="font-size: 26px;">chat_bubble_outline</i>
                        </a>

                        <a class="waves-effect waves-block waves-light profile-button" href="javascript:void(0);"
                            style="display: flex; align-items: center; padding-left: 5px;">
                            <img style="height: 38px; width: 38px; object-fit: cover; border-radius: 50%; border: 1.5px solid #1e88e5;"
                                id="pmler" src="../profile/index/secured/images/userlogo.png" alt="avatar">
                        </a>
                    </div>

                </div>
            </nav>
        </div>
    </header>


    <aside class="sidenav-main nav-expanded nav-lock nav-collapsible sidenav-light">
        <div class="brand-sidebar"
            style="background: white !important; height: 64px; display: flex; align-items: center; justify-content: center;">
            <a class="brand-logo" href="../index.html">
                <img style="width: 150px; object-fit: contain;" src="../logo.png" alt="Blue Block Logo" />
            </a>
        </div>

        <ul class="sidenav leftside-navigation collapsible sidenav-fixed" id="slide-out">
            <li class="profile-box-custom">
                <div style="display: flex; align-items: center;">
                    <img src="../profile/index/secured/images/userlogo.png" id="pmler2"
                        style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #2196f3; object-fit: cover;">
                    <div style="margin-left: 15px; color: #fff;">
                        <span id="weuss"
                            style="font-weight: 700; display: block; font-size: 14px; margin-bottom: 2px;">loading...</span>
                        <div style="display: flex; align-items: center;">
                            <span id="country" style="font-size: 12px; opacity: 0.8;">loading...</span>
                            <img id="flag" src="../profile/index/secured/images/userlogo.png" alt="flag">
                        </div>
                    </div>
                </div>
            </li>

            <li><a class="waves-effect" href="../index.html"><i
                        class="material-icons">dashboard</i><span>Dashboard</span></a></li>
            <li><a class="waves-effect" href="../fund-wallet/index.html"><i
                        class="material-icons">account_balance_wallet</i><span>Fund Account</span></a></li>
            <li><a class="waves-effect" href="../investments/index.html"><i
                        class="material-icons">format_list_bulleted</i><span>Pending Deposit</span></a></li>
            <li><a class="waves-effect" href="../trade_history/index.html"><i class="material-icons">dns</i><span>Trade
                        History</span></a></li>
            <li><a class="waves-effect" href="../withdraw-funds/index.html"><i
                        class="material-icons">attach_money</i><span>Withdraw Funds</span></a></li>
            <li><a class="waves-effect" href="../market_history/index.html"><i
                        class="material-icons">shopping_bag</i><span>Pending Withdraw</span></a></li>
            <li><a class="waves-effect" href="../deposit_list/index.html"><i
                        class="material-icons">confirmation_number</i><span>Approved Deposit</span></a></li>
            <li><a class="waves-effect" href="../withdrawal-history/index.html"><i
                        class="material-icons">folder</i><span>Withdrawal History</span></a></li>

            <li class="active"><a class="waves-effect" href="#"><i
                        class="material-icons">account_circle</i><span>Account Settings</span></a></li>

            <li>
                <a class="waves-effect" id="out" href="javascript:void(0);">
                    <i class="material-icons">exit_to_app</i>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- END: SideNav--> <!-- END: SideNav-->

    <!-- BEGIN: Page Main-->
    <div id="main">
        <div class="row">
            <div style="background: linear-gradient(#07132fc7, rgb(22 68 132 / 86%) 99.58%), url(app-assets/images/bg-1.jpg) !important; background-position: center;
        background-size: cover !important; background-repeat: no-repeat; height: 250px !important;"
                class="content-wrapper-before gradient-45deg-indigo-purple"></div>
            <div class="breadcrumbs-dark pb-0 pt-4" id="breadcrumbs-wrapper">
                <!-- Search for small screen-->
                <div class="container">
                    <div class="row">
                        <div class="col s12 m6 l6">
                            <h5 class="breadcrumbs-title mt-0 mb-0"><span>Account Settings</span></h5>
                            <ol class="breadcrumbs mb-0">
                                <li class="breadcrumb-item"><a href="../index.html">Home</a>
                                </li>

                                <li class="breadcrumb-item active"> Account Settings
                                </li>
                            </ol>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col s12">
                <div class="container">
                    <!-- Account settings -->
                    <section class="tabs-vertical mt-1 section">
                        <div class="row">
                            <div class="col l4 s12">


                                <div class="row valign-wrapper mt-10 pt-2 animate fadeLeft">
                                    <div class="col s3 media-image">
                                        <img src="../profile/index/secured/images/userlogo.png" id="pmler3" alt=""
                                            class="circle z-depth-2 responsive-img">
                                        <!-- notice the "circle" class -->
                                    </div>
                                    <div class="col s9" style="color: #fff;">
                                        <p class="m-0 subtitle font-weight-700" id="weuss2">loading...</p>
                                        <p class="m-0 subtitle font-weight-700" style="display: flex;">
                                            <span style="font-size: 14px;" id="country2">
                                                loading... </span> <img style="margin-left: 10px;" width="20"
                                                src="../profile/index/secured/images/userlogo.png" id="flag2"
                                                alt="User's Country">
                                        </p>
                                        <p class="m-0 text-muted" style="font-size: 12px;">Blue Block Investor</p>
                                    </div>
                                </div>

                                <!-- tabs  -->
                                <div class="card-panel">
                                    <ul class="tabs">
                                        <li class="tab">
                                            <a href="#general">
                                                <i class="material-icons">brightness_low</i>
                                                <span>General</span>
                                            </a>
                                        </li>
                                        <li class="tab">
                                            <a href="#wallets">
                                                <i class="material-icons">account_balance_wallet</i>
                                                <span>Cryp Chain ID</span>
                                            </a>
                                        </li>
                                        <li class="tab">
                                            <a href="#change-password">
                                                <i class="material-icons">lock_open</i>
                                                <span>Change Password</span>
                                            </a>
                                        </li>

                                        <li class="tab">
                                            <a id="m-logout">
                                                <i class="material-icons">exit_to_app</i>
                                                <span>Logout</span>
                                            </a>
                                        </li>


                                    </ul>
                                </div>
                            </div>
                            <div class="col l8 s12">
                                <!-- tabs content -->
                                <div id="general">
                                    <div class="card-panel">



                                        <!-- SPINNER DIV -->
                                        <div id="spinnerModal" class="spinner-modal" style="display: none;">
                                            <div class="spinner-content">
                                                <div class="spinner"></div>
                                                <p>Loading, please wait...</p>
                                            </div>
                                        </div>
                                        <!-- SPINNER DIV -->





                                        <form class="formValidate" id="userfom">
                                            <div class="row">
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="firstName">First Name</label>
                                                        <br>
                                                        <p></p>
                                                        <input type="text" id="firstName" name="firstName" value=""
                                                            data-error=".errorTxt1">
                                                        <small class="errorTxt1"></small>
                                                    </div>
                                                </div>

                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="lastName">Last Name</label>
                                                        <br>
                                                        <p></p>
                                                        <input type="text" id="lastName" name="lastName" value=""
                                                            data-error=".errorTxt1">
                                                        <small class="errorTxt1"></small>
                                                    </div>
                                                </div>

                                                <div class="col s12 m6">
                                                    <div class="input-field">
                                                        <select id="gender" class="browser-default">
                                                            <option value="" disabled selected>Select Gender</option>
                                                            <option value="Male">Male</option>
                                                            <option value="Female">Female</option>
                                                            <option value="Other">Other</option>
                                                        </select>
                                                        <label class="active"
                                                            style="position:relative; top:0;">Gender</label>
                                                    </div>
                                                </div>

                                                <div class="col s12 m6">
                                                    <div class="input-field">
                                                        <input type="date" id="dataof_birth" class="datepicker-custom">
                                                        <label class="active" for="dataof_birth">Date of Birth</label>
                                                    </div>
                                                </div>

                                                <div class="col s12 m6">
                                                    <div class="input-field">
                                                        <input type="text" id="state" placeholder="e.g. California">
                                                        <label class="active" for="state">State/Province</label>
                                                    </div>
                                                </div>

                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="name">Phone</label>
                                                        <br>
                                                        <p></p>
                                                        <input id="phone" name="phone" type="text" value=""
                                                            data-error=".errorTxt2">
                                                        <small class="errorTxt2"></small>
                                                    </div>
                                                </div>

                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="imageUpload">Change Profile Image</label>
                                                        <br>
                                                        <p></p>
                                                        <input id="imageUpload" name="imageUpload" type="file" value="">
                                                        <small class="errorTxt2"></small>
                                                    </div>
                                                </div>

                                                <hr>
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="email">Email</label>
                                                        <br>
                                                        <p></p>
                                                        <input disabled id="email" name="email" type="email" value=""
                                                            data-error=".errorTxt2">
                                                        <small class="errorTxt2"></small>
                                                    </div>
                                                </div>



                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="email">Registration Date</label>
                                                        <br>
                                                        <p></p>
                                                        <input disabled id="date" type="text" name="date" value=""
                                                            data-error=".errorTxt3">
                                                        <small class="errorTxt3"></small>
                                                    </div>
                                                </div>

                                                <div class="col s12">
                                                    <div class="input-field">

                                                        <input style="color: #fff !important"
                                                            class="btn indigo mr-1 save_btc" id="" type="submit"
                                                            name="date" value="Update" data-error=".errorTxt3">
                                                        <small class="errorTxt3"></small>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <div id="wallets">
                                    <div class="card-panel">
                                        <div>
                                            <div class="row">
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <label for="loginIDDisplay">Unique Login ID</label>
                                                        <br>
                                                        <p></p>
                                                        <input readonly id="loginIDDisplay" type="text"
                                                            name="loginIDDisplay" value="Loading..."
                                                            style="font-weight: bold; color: #1e88e5; background: #f5f5f5; border-radius: 4px; padding-left: 10px;">
                                                    </div>
                                                </div>

                                                <div class="col s12 display-flex justify-content-end form-action">
                                                    <button type="button" onclick="updateLoginID()"
                                                        class="btn orange waves-effect waves-light mr-1">
                                                        <i class="material-icons left">refresh</i> Regenerate
                                                    </button>

                                                    <button type="button" onclick="copyLoginID()"
                                                        class="btn btn-light-pink waves-effect waves-light">
                                                        <i class="material-icons left">content_copy</i> Copy ID
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="change-password">
                                    <div class="card-panel">
                                        <form class="paaswordvalidate" id="passch">
                                            <div class="row">
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <input id="oldPassword" minlength="8" name="oldPassword"
                                                            type="password" data-error=".errorTxt4">
                                                        <label for="oldPassword">Current Password</label>
                                                        <small class="errorTxt4"></small>
                                                    </div>
                                                </div>
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <input id="newPassword" minlength="8" name="newPassword"
                                                            type="password" data-error=".errorTxt5">
                                                        <label for="newPassword">New Password</label>
                                                        <small class="errorTxt5"></small>
                                                    </div>
                                                </div>
                                                <div class="col s12">
                                                    <div class="input-field">
                                                        <input id="newPassword2" minlength="8" type="password"
                                                            name="newPassword2" data-error=".errorTxt6">
                                                        <label for="newPassword2">Retype new Password</label>
                                                        <small class="errorTxt6"></small>
                                                    </div>
                                                </div>
                                                <div class="col s12 display-flex justify-content-end form-action">

                                                    <input style="color: #fff !important" type="submit"
                                                        value="Update Password" class="btn indigo mr-1">

                                                    <button type="reset" id="reset_btn"
                                                        class="btn btn-light-pink waves-effect waves-light">Cancel</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section><!-- START RIGHT SIDEBAR NAV -->

                    <!-- END RIGHT SIDEBAR NAV -->
                </div>
                <div class="content-overlay"></div>
            </div>
        </div>
    </div>
    <!-- END: Page Main-->


    <!-- BEGIN: Footer-->

    <footer style="background: #01123c !important;"
        class="page-footer footer footer-static footer-dark gradient-45deg-indigo-purple gradient-shadow navbar-border navbar-shadow">
        <div class="footer-copyright">
            <div class="container" style="text-align: center;"><span>&copy; 2025 <a href="#" target="_blank">Blue
                        Block</a> All rights reserved.</span></div>
        </div>
    </footer>



    <!-- SPINNER CSS -->
    <style>
        .spinner-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.938);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner-content {
            text-align: center;
            color: white;
        }

        .spinner {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #ffffff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <div class="mobile-bottom-nav">
        <a href="../index.html" class="mobile-nav-item">
            <i class="material-icons">dashboard</i>
            <span>Dashboard</span>
        </a>
        <a href="../fund-wallet/index.html" class="mobile-nav-item">
            <i class="material-icons">account_balance_wallet</i>
            <span>Fund</span>
        </a>
        <a href="javascript:void(0);" onclick="showHistoryOptions()" class="mobile-nav-item">
            <i class="material-icons">history</i>
            <span>History</span>
        </a>
        <a href="../withdraw-funds/index.html" class="mobile-nav-item">
            <i class="material-icons">attach_money</i>
            <span>Withdraw</span>
        </a>
        <a href="#" class="mobile-nav-item active">
            <i class="material-icons">settings</i>
            <span>Settings</span>
        </a>
    </div>

    <script src="//code.jivosite.com/widget/mzF45pvueS" async></script>

    <script>
        // CRITICAL: We DO NOT call jivo_api.hide() here.
        // That command disables the chat entirely.
        function jivo_onLoadCallback() {
            // This tells Jivosite's own engine to hide the trigger button
            if (typeof jivo_api !== 'undefined') {
                jivo_api.hide();
                // Note: jivo_api.hide() hides the BUTTON, but jivo_api.open() will still work.
            }
        }

        // Enhanced killer that watches for DOM changes
        const observer = new MutationObserver(() => {
            const bubble = document.querySelector('jdiv[class^="button_"], jdiv[class^="label_"]');
            if (bubble && bubble.style.display !== 'none') {
                bubble.style.setProperty('display', 'none', 'important');
            }
        });

        observer.observe(document.body, { childList: true, subtree: true });
    </script>
</body>


<!--   -->

</html>