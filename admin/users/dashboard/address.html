<!DOCTYPE html>
<html lang="en"><!-- [Head] start -->

<head>
  <title>origin admin</title>
  <!-- [Meta] -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description"
    content="Light Able admin and dashboard template offer a variety of UI elements and pages, ensuring your admin panel is both fast and effective.">
  <meta name="author" content="phoenixcoded">

  <!-- [Favicon] icon -->
  <link rel="icon" href="../assets/images/favicon.svg" type="image/x-icon">
  <!-- [Google Font : Public Sans] icon -->
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- [phosphor Icons] https://phosphoricons.com/ -->
  <link rel="stylesheet" href="../assets/fonts/phosphor/duotone/style.css">
  <!-- [Tabler Icons] https://tablericons.com -->
  <link rel="stylesheet" href="../assets/fonts/tabler-icons.min.css">
  <!-- [Feather Icons] https://feathericons.com -->
  <link rel="stylesheet" href="../assets/fonts/feather.css">
  <!-- [Font Awesome Icons] https://fontawesome.com/icons -->
  <link rel="stylesheet" href="../assets/fonts/fontawesome.css">
  <!-- [Material Icons] https://fonts.google.com/icons -->
  <link rel="stylesheet" href="../assets/fonts/material.css">
  <!-- [Template CSS Files] -->
  <link rel="stylesheet" href="../assets/css/style.css" id="main-style-link">
  <link rel="stylesheet" href="../assets/css/style-preset.css">


  <!-- POPUP SCRIPT -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="sweetalert2.min.js"></script>
  <link rel="stylesheet" href="sweetalert2.min.css">
  <script src="../../../config.js"></script>
  <script type="module">
    // 1. Direct Import to bypass supabase.js auth guards
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

    // 2. Initialize connection
    const supabase = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_KEY);

    const assets = ["Bitcoin", "Ethereum", "Solana", "Binance", "Ripple", "Cardano", "Polygon", "Polkadot", "Litecoin", "Avalanche", "Chainlink", "Shiba"];

    /**
     * INITIAL DATA LOAD
     */
    async function loadDashboardData() {
      // Step A: Check 'active' status once at start
      const { data: admin } = await supabase.from('admin').select('active').eq('id', 1).single();

      if (!admin || admin.active !== true) {
        return handleAccessDenied();
      }

      // Step B: Load asset addresses
      const { data: addressData, error } = await supabase.from('address').select('*').eq('id', 1).single();

      if (error) {
        console.error("Error loading addresses:", error.message);
      }

      if (addressData) {
        assets.forEach(key => {
          const input = document.getElementById(key);
          if (input) input.value = addressData[key] || "";
        });
      }

      // Step C: Start Real-time Monitor for the 'active' status
      startRealtimeMonitor();
    }

    /**
     * REAL-TIME MONITOR
     * Listen for any changes to the admin table in real-time
     */
    function startRealtimeMonitor() {
      supabase
        .channel('admin_status_check')
        .on(
          'postgres_changes',
          { event: 'UPDATE', schema: 'public', table: 'admin', filter: 'id=eq.1' },
          (payload) => {
            // If the active status is changed to false in the DB, kick the admin immediately
            if (payload.new.active === false || payload.new.active === 'false') {
              handleAccessDenied();
            }
          }
        )
        .subscribe();
    }

    function handleAccessDenied() {
      Swal.fire({
        title: 'Access Denied',
        text: 'Your session has been deactivated. Contact Developer.',
        icon: 'error',
        allowOutsideClick: false
      }).then(() => {
        window.location.href = "../../login/index.html";
      });
    }

    /**
     * FORM SUBMISSION (Save Changes)
     */
    document.getElementById('userfom').addEventListener('submit', async (e) => {
      e.preventDefault();
      const updates = {};
      const formData = new FormData(e.target);
      assets.forEach(key => { updates[key] = formData.get(key); });

      const { error } = await supabase.from('address').update(updates).eq('id', 1);

      if (error) {
        Swal.fire('Error', error.message, 'error');
      } else {
        Swal.fire('Success', 'Addresses Saved Successfully', 'success');
      }
    });

    // Run on startup
    loadDashboardData();
  </script>

</head>
<!-- [Head] end -->
<!-- [Body] Start -->

<body data-pc-preset="preset-1" data-pc-sidebar-theme="light" data-pc-sidebar-caption="true" data-pc-direction="ltr"
  data-pc-theme="light">
  <!-- [ Pre-loader ] start -->
  <div class="loader-bg">
    <div class="loader-track">
      <div class="loader-fill"></div>
    </div>
  </div>
  <!-- [ Pre-loader ] End -->
  <!-- [ Sidebar Menu ] start -->
  <nav class="pc-sidebar">
    <div class="navbar-wrapper">
      <div class="m-header">
        <a class="b-brand text-primary">
          <!-- ========   Change your logo from here   ============ -->
          <!-- <img src="../assets/images/logo-dark.svg" alt="logo image" class="logo-lg"> -->
          <h1>Administrator</h1>
        </a>
      </div>
      <div class="navbar-content">
        <ul class="pc-navbar">
          <li class="pc-item pc-caption">
            <label data-i18n="Navigation">Navigation</label>
            <i class="ph-duotone ph-gauge"></i>
          </li>


          <li class="pc-item">
            <a href="./users.html" class="pc-link">
              <span class="pc-micon">
                <i class="ph-duotone ph-identification-card"></i>
              </span>
              <span class="pc-mtext" data-i18n="Users">Users</span>
            </a>
          </li>
          <li class="pc-item">
            <a href="#" class="pc-link">
              <span class="pc-micon">
                <i class="ph-duotone ph-globe"></i>
              </span>
              <span class="pc-mtext" data-i18n="Address">Address</span>
            </a>
          </li>
          <li class="pc-item">
            <a href="../../profile/account/settings.html" class="pc-link">
              <span class="pc-micon">
                <i class="ph-duotone ph-wrench"></i>
              </span>
              <span class="pc-mtext" data-i18n="settings">Settings</span>
            </a>
          </li>

      </div>
      <div class="card pc-user-card">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <div class="flex-shrink-0">
              <img src="../assets/images/user/avatar-1.jpg" alt="user-image" class="user-avtar wid-45 rounded-circle">
            </div>
            <div class="flex-grow-1 ms-3">
              <div class="dropdown">
                <a href="#" class="arrow-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"
                  data-bs-offset="0,20">
                  <div class="d-flex align-items-center">
                    <div class="flex-grow-1 me-2">
                      <h6 class="mb-0">Administrator</h6>
                    </div>
                    <div class="flex-shrink-0">
                      <div class="btn btn-icon btn-link-secondary avtar">
                        <i class="ph-duotone ph-windows-logo"></i>
                      </div>
                    </div>
                  </div>
                </a>
                <div class="dropdown-menu">
                  <ul>

                    <li>
                      <a href="../../login/index.html" class="pc-user-links">
                        <i class="ph-duotone ph-power"></i>
                        <span>Logout</span>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <!-- [ Sidebar Menu ] end -->
  <!-- [ Header Topbar ] start -->
  <header class="pc-header">
    <div class="header-wrapper"> <!-- [Mobile Media Block] start -->
      <div class="me-auto pc-mob-drp">
        <ul class="list-unstyled">
          <!-- ======= Menu collapse Icon ===== -->
          <li class="pc-h-item pc-sidebar-collapse">
            <a href="#" class="pc-head-link ms-0" id="sidebar-hide">
              <i class="ti ti-menu-2"></i>
            </a>
          </li>
          <li class="pc-h-item pc-sidebar-popup">
            <a href="#" class="pc-head-link ms-0" id="mobile-collapse">
              <i class="ti ti-menu-2"></i>
            </a>
          </li>


        </ul>
      </div>
      <!-- [Mobile Media Block end] -->
      <div class="ms-auto">
        <ul class="list-unstyled">


          <li class="pc-h-item">
            <a class="pc-head-link pct-c-btn" href="#" data-bs-toggle="offcanvas" data-bs-target="#offcanvas_pc_layout">
              <i class="ph-duotone ph-gear-six"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </header>
  <!-- [ Header ] end -->



  <!-- [ Main Content ] start -->
  <div class="pc-container">
    <div class="pc-content">
      <!-- [ breadcrumb ] start -->
      <div class="page-header">
        <div class="page-block">
          <div class="row align-items-center">

            <div class="col-md-12">
              <div class="page-header-title">
                <h2 class="mb-0">All Address</h2>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- [ breadcrumb ] end -->


      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- [ sample-page ] start -->
        <div class="col-sm-12">
          <div class="card">

            <form id="userfom">
              <div class="row">

                <div class="col-md-6">

                </div>
              </div>
              <div class="card">
                <div class="card-body">
                  <div class="row">
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Bitcoin (BTC)</label>
                      <input name="Bitcoin" id="Bitcoin" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Ethereum (ETH)</label>
                      <input name="Ethereum" id="Ethereum" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Solana (SOL)</label>
                      <input name="Solana" id="Solana" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Binance (BNB)</label>
                      <input name="Binance" id="Binance" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Ripple (XRP)</label>
                      <input name="Ripple" id="Ripple" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Cardano (ADA)</label>
                      <input name="Cardano" id="Cardano" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Polygon (MATIC)</label>
                      <input name="Polygon" id="Polygon" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Polkadot (DOT)</label>
                      <input name="Polkadot" id="Polkadot" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Litecoin (LTC)</label>
                      <input name="Litecoin" id="Litecoin" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Avalanche (AVAX)</label>
                      <input name="Avalanche" id="Avalanche" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Chainlink (LINK)</label>
                      <input name="Chainlink" id="Chainlink" type="text" class="form-control">
                    </div>
                    <div class="col-sm-6 mb-3">
                      <label class="form-label">Shiba Inu (SHIB)</label>
                      <input name="Shiba" id="Shiba" type="text" class="form-control">
                    </div>
                  </div>
                </div>
              </div>
              <button type="submit" class="btn btn-primary mb-4 w-100">Update Addresses</button>


            </form>
          </div>
        </div>
        <!-- [ sample-page ] end -->
      </div>
      <!-- [ Main Content ] end -->
    </div>
  </div>
  <!-- [ Main Content ] end -->
  <footer class="pc-footer">
    <div class="footer-wrapper container-fluid">

    </div>
  </footer>
  <!-- Required Js -->
  <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
  <script src="../assets/js/plugins/popper.min.js"></script>
  <script src="../assets/js/plugins/simplebar.min.js"></script>
  <script src="../assets/js/plugins/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/i18next.min.js"></script>
  <script src="../assets/js/plugins/i18nextHttpBackend.min.js"></script>
  <script src="../assets/js/icon/custom-font.js"></script>
  <script src="../assets/js/script.js"></script>
  <script src="../assets/js/theme.js"></script>
  <script src="../assets/js/multi-lang.js"></script>
  <script src="../assets/js/plugins/feather.min.js"></script>


  <script>
    layout_change('light');
  </script>

  <script>
    layout_sidebar_change('light');
  </script>

  <script>
    change_box_container('false');
  </script>

  <script>
    layout_caption_change('true');
  </script>

  <script>
    layout_rtl_change('false');
  </script>

  <script>
    preset_change('preset-1');
  </script>

  <div class="offcanvas border-0 pct-offcanvas offcanvas-end" tabindex="-1" id="offcanvas_pc_layout">
    <div class="offcanvas-header justify-content-between">
      <h5 class="offcanvas-title">Settings</h5>
      <button type="button" class="btn btn-icon btn-link-danger" data-bs-dismiss="offcanvas" aria-label="Close"><i
          class="ti ti-x"></i></button>
    </div>
    <div class="pct-body customizer-body">
      <div class="offcanvas-body py-0">
        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            <div class="pc-dark">
              <h6 class="mb-1">Theme Mode</h6>
              <p class="text-muted text-sm">Choose light or dark mode or Auto</p>
              <div class="row theme-color theme-layout">
                <div class="col-4">
                  <div class="d-grid">
                    <button class="preset-btn btn active" data-value="true" onclick="layout_change('light');">
                      <span class="btn-label">Light</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                    </button>
                  </div>
                </div>
                <div class="col-4">
                  <div class="d-grid">
                    <button class="preset-btn btn" data-value="false" onclick="layout_change('dark');">
                      <span class="btn-label">Dark</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                    </button>
                  </div>
                </div>
                <div class="col-4">
                  <div class="d-grid">
                    <button class="preset-btn btn" data-value="default" onclick="layout_change_default();"
                      data-bs-toggle="tooltip"
                      title="Automatically sets the theme based on user's operating system's color scheme.">
                      <span class="btn-label">Default</span>
                      <span class="pc-lay-icon d-flex align-items-center justify-content-center">
                        <i class="ph-duotone ph-cpu"></i>
                      </span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </li>
          <li class="list-group-item pc-sidebar-color">
            <h6 class="mb-1">Sidebar Theme</h6>
            <p class="text-muted text-sm">Choose Sidebar Theme</p>
            <div class="row theme-color theme-sidebar-color">
              <div class="col-6">
                <div class="d-grid">
                  <button class="preset-btn btn" data-value="true" onclick="layout_sidebar_change('dark');">
                    <span class="btn-label">Dark</span>
                    <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                  </button>
                </div>
              </div>
              <div class="col-6">
                <div class="d-grid">
                  <button class="preset-btn btn active" data-value="false" onclick="layout_sidebar_change('light');">
                    <span class="btn-label">Light</span>
                    <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                  </button>
                </div>
              </div>
            </div>
          </li>
          <li class="list-group-item">
            <h6 class="mb-1">Accent color</h6>
            <p class="text-muted text-sm">Choose your primary theme color</p>
            <div class="theme-color preset-color">
              <a href="#!" class="active" data-value="preset-1"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-2"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-3"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-4"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-5"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-6"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-7"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-8"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-9"><i class="ti ti-check"></i></a>
              <a href="#!" data-value="preset-10"><i class="ti ti-check"></i></a>
            </div>
          </li>
          <li class="list-group-item">
            <h6 class="mb-1">Sidebar Caption</h6>
            <p class="text-muted text-sm">Sidebar Caption Hide/Show</p>
            <div class="row theme-color theme-nav-caption">
              <div class="col-6">
                <div class="d-grid">
                  <button class="preset-btn btn active" data-value="true" onclick="layout_caption_change('true');">
                    <span class="btn-label">Caption Show</span>
                    <span
                      class="pc-lay-icon"><span></span><span></span><span><span></span><span></span></span><span></span></span>
                  </button>
                </div>
              </div>
              <div class="col-6">
                <div class="d-grid">
                  <button class="preset-btn btn" data-value="false" onclick="layout_caption_change('false');">
                    <span class="btn-label">Caption Hide</span>
                    <span
                      class="pc-lay-icon"><span></span><span></span><span><span></span><span></span></span><span></span></span>
                  </button>
                </div>
              </div>
            </div>
          </li>
          <li class="list-group-item">
            <div class="pc-rtl">
              <h6 class="mb-1">Theme Layout</h6>
              <p class="text-muted text-sm">LTR/RTL</p>
              <div class="row theme-color theme-direction">
                <div class="col-6">
                  <div class="d-grid">
                    <button class="preset-btn btn active" data-value="false" onclick="layout_rtl_change('false');">
                      <span class="btn-label">LTR</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                    </button>
                  </div>
                </div>
                <div class="col-6">
                  <div class="d-grid">
                    <button class="preset-btn btn" data-value="true" onclick="layout_rtl_change('true');">
                      <span class="btn-label">RTL</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span></span></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </li>
          <li class="list-group-item pc-box-width">
            <div class="pc-container-width">
              <h6 class="mb-1">Layout Width</h6>
              <p class="text-muted text-sm">Choose Full or Container Layout</p>
              <div class="row theme-color theme-container">
                <div class="col-6">
                  <div class="d-grid">
                    <button class="preset-btn btn active" data-value="false" onclick="change_box_container('false')">
                      <span class="btn-label">Full Width</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span><span></span></span></span>
                    </button>
                  </div>
                </div>
                <div class="col-6">
                  <div class="d-grid">
                    <button class="preset-btn btn" data-value="true" onclick="change_box_container('true')">
                      <span class="btn-label">Fixed Width</span>
                      <span class="pc-lay-icon"><span></span><span></span><span></span><span><span></span></span></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </li>
          <li class="list-group-item">
            <div class="d-grid">
              <button class="btn btn-light-danger" id="layoutreset">Reset Layout</button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- SPINNER CSS -->
  <style>
    .spinner-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.938);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .spinner-content {
      text-align: center;
      color: white;
    }

    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #ffffff;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>


</body><!-- [Body] end -->

</html>